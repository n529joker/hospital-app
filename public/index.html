<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>load data</title>
</head>
<body>
    <select name="Regions" id="regions" style="width:150px;">
        <option value="Northwest">NW</option>
        <option value="Southwest">SW</option>
        <option value="West">WE</option>
        <option value="Littoral">LT</option>
    </select>
    <button onclick="checkdata()">check data</button>
    <script>
        document.addEventListener('DOMContentLoaded',getData)
async function getData(){
     try{
       let data = await fetch('http://ip-api.com/json')
       let fdata = await data.json()
       let reg = localStorage.getItem('region')
       if(reg == null || reg == undefined || reg !== fdata.regionName){
        localStorage.setItem('region',`${fdata.regionName}`)
        alert('New Region added!')
       }else{
        let RE = localStorage.getItem('region')
        let reg = {
            region:RE
        }
        let data = {
            method: 'POST',
            header:{
                'Content-Type':'application/json'
            },
            body: JSON.stringify(reg)
        }
        let sdata = await fetch('https://hospitalcmr.herokuapp.com/data', data)
        let res = await sdata.json()
        console.log(res)
       }

    }
    catch(ex){
        console.log('Request failed ', ex);
     }
}


    </script>
</body>
</html>
