<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>load data</title>
</head>
<body>
    <p>hello Manka add /fdata to the url </p>
    <script>
        document.addEventListener('DOMContentLoaded',getData)
        async function getData(){
     try{
       let data = await fetch('https://ipgeolocation.abstractapi.com/v1/?api_key=ae155d7394704c93be9c72486e2bd7f5')
       let fdata = await data.json()
       console.log(fdata)
       let reg = localStorage.getItem('region')
       if(reg == null || reg == undefined || reg !== fdata.regionName){
        localStorage.setItem('region',`${fdata.region}`)
        alert('New Region added!')
       }else{
        let RE = localStorage.getItem('region')
        let reg = {
            region:RE
        }
        let data = {
            method: 'POST',
            header:{
                'Content-Type':'application/json'
            },
            body: JSON.stringify(reg)
        }
        let sdata = await fetch('https://hospitalcmr.herokuapp.com/data', data)
        let res = await sdata.json()
        console.log(res)
       }

    }
    catch(ex){
        console.log('Request failed ', ex);
     }
}


    </script>
</body>
</html>
